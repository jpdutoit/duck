import "assert";

generator A {
  mono output = 0;
  function tick() {
    output = output + 1;
  }
}

generator B {
  mono input = 0;
  mono output = 0;
  function tick() {
    output = input * 2;
  }
}

generator C {
  mono input = 0;
  mono output = 0;
  function tick() {
    output = input + 1;
  }
}

A >> B >> C >> Assert([3, 5, 7, 9, 11]);
A.output >> B >> Assert([2, 4, 6, 8, 10]);
A >> C >> Assert([2, 3, 4, 5, 6]).input;

A >> C c1 >> Assert([1, 1, 1, 1, 1]).input;
0 >> c1.input;

A >> C c2 >> Assert([1, 1, 1, 1, 1]).input;
c2.input = 0;

now += 5 samples;


extern generator DAC {
  mono input;
}
generator D {
  mono input;
  DAC dac;
  function tick() {
    dac.input = input;
  }
}

0 >> D;
